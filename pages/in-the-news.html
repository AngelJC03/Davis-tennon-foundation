<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Davis - Tennon Foundation</title>

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Davis - Tennon Foundation" />
    <meta property="og:description" content="Empowering communities through education, leadership, and opportunity." />
    <meta property="og:image" content="https://davis-tennonfoundation.org/images/logo-photos/clear-background-dtf-logo.png" />
    <meta property="og:url" content="https://davis-tennonfoundation.org/" />
    <meta property="og:type" content="website" />

    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" href= "../images/logo-photos/Logo-emblem.png" type="image/x-icon" />
    <script src="../js/capitalize.js"></script>
</head>
<body>
    <section class="banner" id="home">
        <div class="banner-container">
            <div class="burger">
                <img src="../images/menu.png" alt="Menu" class="menu-icon" onclick="menutoggle()">
                <div class="burger-menu-content" id="burger-menu-content">
                    <a href="violas-story.html">About Viola and Julius</a>
                    <a href="in-the-news.html">In The News</a>
                    <a href="foundation-staff.html" >Foundation Staff</a>
                    <a href="what-we-fund.html">What We Fund</a>
                    <a href="board-members.html">Board Members</a>
                    <a href="partners.html">Partners/Resources</a>
                  </div>
            </div>
            <a href="../index.html">
                <img src="../images/logo-photos/clear-background-dtf-logo.png" alt="Image" width="500" height="155">
            </a>
            <a href="https://givebutter.com/0nhBTh" class="btn">Donate Now</a>
            <a href="https://docs.google.com/forms/d/e/1FAIpQLSeyf2L9swDTLg0CM6kyN8VamFCxlJ4w-BgiWQihqsM--hBiWA/viewform" class="btn2">Apply For Funding</a>
        </div>
    </section>

    
    
    <header>
        <div class="orangebar">
            <div class="orange-container">
            </div>
        </div>
        <div class="navbar-container"> 
            <nav>
                <a href="violas-story.html" class="btn">About Viola and Julius</a>
                <a href="in-the-news.html" class="btn">In The News</a>
                <a href="foundation-staff.html" class="btn">Foundation Staff</a>
                <a href="what-we-fund.html" class="btn">What We Fund</a>
                <a href="board-members.html" class="btn">Board Members</a>
                <a href="partners.html" class="btn">Partners/Resources</a>
            </nav>
        </div>
    </header>

    <style>     
        h2 {
            font-size: 32px;
            margin: 20px 0;
            text-align: center;
        }
        .divider {
            border-bottom: 2px solid grey;
            width: 50%;
            margin: 10px auto;
        }
        .container {
            width: 100%;
            max-width: 700px; /* Increased width */
            margin: auto;
            padding: 20px;
        }
        .row {
            display: flex;
            align-items: flex-start;
            padding: 10px 0;
            border-bottom: 1px solid grey;
            cursor: pointer;
        }
        .image {
            flex-shrink: 0;
            margin-right: 10px;
        }
        .image img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 5px;
        }
        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .date {
            font-size: 14px;
            color: grey;
            margin-bottom: 5px;
        }
        .title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .description {
            font-size: 14px;
            color: #333;
        }
        .read-more {
            color: blue;
            cursor: pointer;
        }
        .show-more-container {
            text-align: center;
            margin: 20px 0;
        }
        .show-more {
            font-family: "gill-sans-bold";
            background-color: rgb(255,186,95);
            color: rgb(0, 0, 0);
            border: none;
            padding: 10px 15px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            display: none; /* Initially hidden */
        }

        .popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            max-width: 500px;
            background: white;
            padding: 20px 10px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }
        .popup-close {
            cursor: pointer;
            color: red;
            font-size: 24px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 15px;
            
        }
        .loading {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            height: 30vh; /* Adjusted height so it doesn't take up too much space */
            font-size: 24px;
            color: #000000;
            margin-top: 20px; /* Space between articles and loading */
        }
        @media (max-width: 500px) {
            .container {
                padding: 10px;
            }
            .row {
                flex-direction: column;
                align-items: flex-start;
                padding: 10px 0;
            }
            .image {
                margin-right: 0;
                margin-bottom: 10px;
            }
            .image img {
                width: 100%;
                height: auto;
            }
        }
    </style>
    <div class="news fade-in">
        <h2>Recent Articles</h2>
        <div class="divider"></div>
        <div class="container" id="data-container"></div>

        <div id="loading" class="loading">
            <p>Loading news...</p>
        </div>
    
        <div class="show-more-container">
            <button class="show-more" id="show-more">Show More</button>
        </div>
    </div>
    
    <!-- Pop-up Modal -->
    <div class="overlay" id="overlay"></div>
    <div class="popup" id="popup">
        <span class="popup-close" onclick="closePopup()">✖</span>
        <div id="popup-content"></div>
    </div>
    
    <script>
        let articles = [];
        let displayedArticles = 0;
        const initialDisplayCount = 6;
        const incrementCount = 6;
    
        async function fetchData() {
            const loadingDiv = document.getElementById("loading");
            loadingDiv.style.display = "flex"; // Show loading div
    
            try {
                // Fetch the config.json to get the API URL
                const configRes = await fetch('config.json');  // Adjusted to the root directory
                if (!configRes.ok) throw new Error(`HTTP error! status: ${configRes.status}`);
                const config = await configRes.json();
                const url = capitalize(config.frameworklink); // Get the API URL from config.json
    
                // Fetch the data from the API
                const response = await fetch(url);
                const data = await response.json();
                articles = data.slice(1); // Remove header row
    
                displayedArticles = initialDisplayCount; // Initialize correctly
                renderArticles();
    
                // Hide the loading div once data is loaded
                loadingDiv.style.display = "none";
    
                if (articles.length > displayedArticles) {
                    document.getElementById("show-more").style.display = "inline-block"; // Show button if more articles exist
                }
            } catch (error) {
                console.error("Error fetching data:", error);
                document.getElementById("data-container").innerHTML = "<p>Error loading data.</p>";
                loadingDiv.style.display = "none"; // Hide loading on error
            }
        }
    
        function renderArticles() {
            const container = document.getElementById("data-container");
    
            // Do not clear articles; instead, render only the new batch
            const toShow = articles.slice(displayedArticles - incrementCount, displayedArticles);
    
            toShow.forEach((row) => {
                let rawDate = row[0];
                const title = row[1];
                const description = row[2];
                const imageUrl = row[4] || "https://via.placeholder.com/100";
                const link = row[3] || "";
    
                console.log("Link:", link); // Debugging
    
                // Format date
                let formattedDate;
                if (rawDate.includes("T")) {
                    const dateObj = new Date(rawDate);
                    formattedDate = dateObj.toLocaleDateString("en-US", {
                        year: "numeric",
                        month: "long",
                        day: "numeric"
                    });
                } else {
                    formattedDate = rawDate;
                }
    
                const truncatedDescription = description.length > 120
                    ? `${description.substring(0, 120)}... <span class="read-more">Read more</span>`
                    : description;
    
                const rowDiv = document.createElement("div");
                rowDiv.classList.add("row");
                rowDiv.innerHTML = `
                    <div class="image">
                        <img src="${imageUrl}" alt="Article Image">
                    </div>
                    <div class="content">
                        <div class="date">${formattedDate}</div>
                        <div class="title">${title}</div>
                        <div class="description">${truncatedDescription}</div>
                    </div>
                `;
    
                // Pass the `link` value when calling `openPopup`
                rowDiv.addEventListener("click", () => openPopup(title, formattedDate, description, imageUrl, link));
    
                container.appendChild(rowDiv);
            });
    
            // Hide button if all articles are shown
            if (displayedArticles >= articles.length) {
                document.getElementById("show-more").style.display = "none";
            }
        }
    
        // Increase displayed count correctly
        document.getElementById("show-more").addEventListener("click", () => {
            displayedArticles += incrementCount;
            renderArticles();
        });
    
        function openPopup(title, date, description, imageUrl, link) {
            document.getElementById("overlay").style.display = "block";
            document.getElementById("popup").style.display = "block";
    
            console.log("Opening popup with link:", link); // Debugging
    
            let linkHTML = link
                ? `<p style="text-align:center; margin-top:15px;">
                     <a href="${link}" target="_blank" rel="noopener noreferrer" class="popup-link" style="color:blue;">
                     Read More...
                     </a>
                   </p>`
                : '';
    
            document.getElementById("popup-content").innerHTML = `
                <h3><a href="${link}" target="_blank" rel="noopener noreferrer" class="popup-link" style="color:blue; width:95%; display:block;">${title}</a></h3>
                <p><strong>${date}</strong></p>
                <img src="${imageUrl}" style="width:100%; border-radius:10px;">
                <p>${description}</p>
                ${linkHTML} <!-- Displays only if the link is available -->
            `;
        }
    
        function closePopup() {
            document.getElementById("overlay").style.display = "none";
            document.getElementById("popup").style.display = "none";
        }
    
        fetchData();
    </script>    

    <!-- <div class="overlay" id="auction-modal-overlay"></div>
    <div class="auction-popup" id="auction-popup-modal">
        <div class="auction-popup-header">
            <span class="auction-popup-close" onclick="closeModal()">&times;</span>
        </div>
        <h2>Bienvenido a la Fundación Davis Tennon</h2>
        <p>Descubre cómo puedes ayudar y contribuir a nuestra causa.</p>
        <a href="https://givebutter.com/0nhBTh" class="btn">Donar Ahora</a>
    </div>   -->

    <footer>
        <div class="footer-container">
            <!-- Left Section: Contact Information -->
            <div class="footer-section contact-info">
                <h4>Contact Us</h4>
                <p>Email: <a href="mailto:agarcia@davis-tennonfoundation.org">agarcia@davis-tennonfoundation.org</a></p>
            </div>
            
            <!-- Middle Section: Logo and Navigation -->
            <div class="footer-section logo-nav">
                <a href="../index.html">
                    <img src="../images/logo-photos/dtf-logo.png" alt="Image" class="footer-logo">
                </a>
                <ul class="nav-links">
                    <li><a href="in-the-news.html">In The News</a></li>
                    <li><a href="foundation-staff.html">Foundation Staff</a></li>
                    <li><a href="what-we-fund.html">What We Fund</a></li>
                </ul>
            </div>
            
            <!-- Right Section: Donate Button -->
            <div class="footer-section socials-donate">
                <ul class="donate-links">
                    <li><a href="https://givebutter.com/0nhBTh" class="btn">Donate Today</a></li>
                </ul>
            </div>
        </div>
        <div class="newsletter-container">
            <h4>NEWSLETTER</h4>
            <p>Subscribe to our newsletter to keep up with the latest news on the Davis-Tennon Foundation!</p>
            <a href="http://eepurl.com/jeVNAE" target="_blank" rel="noopener noreferrer">
                <button class="subscribe-btn">Subscribe Now</button>
            </a>
            <h2>This email is only intended to send you updates on the Davis-Tennon Foundation. You will have the option to unsubscribe at any time.</h2>
        </div>
    </footer>

    
    <script src="../js/main.js"></script>

</body>
</html>
